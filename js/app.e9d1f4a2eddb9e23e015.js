webpackJsonp([0],[,,function(t,e,n){"use strict";var o=n(1),i=n(24),s=n(15),r=n.n(s),a=n(17),c=n.n(a),u=n(16),l=n.n(u),d=n(18),h=n.n(d);o.a.use(i.a),e.a=new i.a({routes:[{path:"/",name:"Auth",component:r.a},{path:"/kom",name:"Kom",component:c.a,beforeEnter:function(t,e,n){n()}},{path:"/confirm",name:"Confirm",component:l.a,props:!0},{path:"/app/*",component:h.a}]})},function(t,e,n){var o=n(0)(n(7),n(22),null,null);t.exports=o.exports},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=n(3),s=n.n(i),r=n(2),a=n(4),c=n.n(a),u=n(5);o.a.use(u.a),o.a.use(c.a),o.a.http.interceptors.push(function(t,e){t.credentials=!0,e()}),o.a.config.productionTip=!1;var l=new u.a.Store({state:{allKoms:[],koms:[]},mutations:{saveKoms:function(t,e){t.koms=e},saveAllKoms:function(t,e){t.allKoms=e}},getters:{getAllKoms:function(t){return t.allKoms},getKoms:function(t){return t.koms}}});new o.a({el:"#app",router:r.a,store:l,template:"<App/>",components:{App:s.a}})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"app"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"hello",mounted:function(){var t=this;this.$http.get("http://localhost:4000/?callback_url=http://localhost:8080/#/kom").then(function(e){t.authorizeButtonHtml=e.body},function(t){console.log("something went wrong")})},data:function(){return{msg:"Welcome to STRAVA SNIPER",authorizeButtonHtml:""}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"confirm",mounted:function(){this.registerServiceWorker()},methods:{submitForm:function(){this.$http.post("http://localhost:4000/confirm",{email:this.email,frequency:this.frequency,koms:this.$store.getters.getKoms}).then(function(t){console.log(t.bodyText)})},registerServiceWorker:function(){var t=this;if(!("serviceWorker"in navigator))return void console.log("Service workers aren't supported in this browser.");navigator.serviceWorker.register("/sw.js").then(function(){return t.initialiseServiceWorker()})},initialiseServiceWorker:function(){var t=this;return"showNotification"in ServiceWorkerRegistration.prototype?"denied"===Notification.permission?void console.log("The user has blocked notifications."):"PushManager"in window?void navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){t.pushButtonDisabled=!1,e&&(t.updateSubscription(e),t.isPushEnabled=!0)}).catch(function(t){console.log("Error during getSubscription()",t)})}):void console.log("Push messaging isn't supported."):void console.log("Notifications aren't supported.")},subscribe:function(){var t=this;navigator.serviceWorker.ready.then(function(e){var n={userVisibleOnly:!0},o=window.Laravel.vapidPublicKey;o&&(n.applicationServerKey=t.urlBase64ToUint8Array(o)),e.pushManager.subscribe(n).then(function(e){t.isPushEnabled=!0,t.pushButtonDisabled=!1,t.updateSubscription(e)}).catch(function(e){"denied"===Notification.permission?(console.log("Permission for Notifications was denied"),t.pushButtonDisabled=!0):(console.log("Unable to subscribe to push.",e),t.pushButtonDisabled=!1)})})},unsubscribe:function(){var t=this;navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){if(!e)return t.isPushEnabled=!1,void(t.pushButtonDisabled=!1);e.unsubscribe().then(function(){t.deleteSubscription(e),t.isPushEnabled=!1,t.pushButtonDisabled=!1}).catch(function(e){console.log("Unsubscription error: ",e),t.pushButtonDisabled=!1})}).catch(function(t){console.log("Error thrown while unsubscribing.",t)})})},togglePush:function(){this.isPushEnabled?this.unsubscribe():this.subscribe()},updateSubscription:function(t){var e=this,n=t.getKey("p256dh"),o=t.getKey("auth"),i={endpoint:t.endpoint,key:n?btoa(String.fromCharCode.apply(null,new Uint8Array(n))):null,token:o?btoa(String.fromCharCode.apply(null,new Uint8Array(o))):null};this.loading=!0,this.$http.post("/subscriptions",i).then(function(){e.loading=!1})},deleteSubscription:function(t){var e=this;this.loading=!0,this.$http.post("/subscriptions/delete",{endpoint:t.endpoint}).then(function(){e.loading=!1})},sendNotification:function(){var t=this;this.loading=!0,this.$http.post("/notifications").catch(function(t){return console.log(t)}).then(function(){t.loading=!1})},urlBase64ToUint8Array:function(t){for(var e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),o=window.atob(n),i=new Uint8Array(o.length),s=0;s<o.length;++s)i[s]=o.charCodeAt(s);return i}},data:function(){return{email:"",frequency:"",loading:!1,isPushEnabled:!1,pushButtonDisabled:!0}}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default={name:"Kom",mounted:function(){var t=this.$store.getters.getAllKoms;if(this.checkedKoms=this.$store.getters.getKoms,t.length)return void(this.koms=t);this.getKoms()},methods:{getKoms:function(){var t=this,e=this;this.$http.get("http://localhost:4000/koms").then(function(n){e.koms=n.body,t.$store.commit("saveAllKoms",n.body)})}},data:function(){return{msg:"Choose your KOMs to track",koms:[],checkedKoms:[]}},watch:{checkedKoms:function(t){this.$store.commit("saveKoms",t)}}}},function(t,e){},function(t,e){},function(t,e){},function(t,e,n){t.exports=n.p+"img/strava.0ab48d1.png"},function(t,e,n){n(12);var o=n(0)(n(8),n(21),"data-v-372e304a",null);t.exports=o.exports},function(t,e,n){n(13);var o=n(0)(n(9),n(23),"data-v-8f24dde4",null);t.exports=o.exports},function(t,e,n){n(11);var o=n(0)(n(10),n(19),"data-v-104f0857",null);t.exports=o.exports},function(t,e,n){var o=n(0)(null,n(20),null,null);t.exports=o.exports},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticStyle:{"margin-bottom":"50px"}},[n("h1",[t._v(t._s(t.msg))]),t._v(" "),n("div",{staticStyle:{"text-align":"left",margin:"0 10%"}},[n("table",[t._m(0),t._v(" "),t._l(t.koms,function(e,o){return n("tr",{class:o%2==0?"redB":""},[n("td",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.checkedKoms,expression:"checkedKoms"}],attrs:{id:e.name,type:"checkbox",name:e.name},domProps:{value:e.segment.id,checked:Array.isArray(t.checkedKoms)?t._i(t.checkedKoms,e.segment.id)>-1:t.checkedKoms},on:{__c:function(n){var o=t.checkedKoms,i=n.target,s=!!i.checked;if(Array.isArray(o)){var r=e.segment.id,a=t._i(o,r);s?a<0&&(t.checkedKoms=o.concat(r)):a>-1&&(t.checkedKoms=o.slice(0,a).concat(o.slice(a+1)))}else t.checkedKoms=s}}})]),t._v(" "),n("td",[n("label",{attrs:{for:e.name}},[t._v(t._s(e.name))])]),t._v(" "),n("td",[n("label",{attrs:{for:e.name}},["Run"===e.segment.activity_type?n("span",{staticClass:"app-icon icon-run icon-dark icon-lg"}):n("span",{staticClass:"app-icon icon-ride icon-dark icon-lg"})])]),t._v(" "),n("td",[n("label",{attrs:{for:e.name}},[t._v(t._s(new Date(e.start_date_local).toLocaleDateString()))])])])})],2)]),t._v(" "),n("router-link",{staticClass:"btn btn-primary btn-sm",attrs:{to:"/confirm"}},[t._v("Next")])],1)},staticRenderFns:[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("tr",[n("th"),t._v(" "),n("th",[t._v("\n          Name\n        ")]),t._v(" "),n("th",[t._v("\n          Type\n        ")]),t._v(" "),n("th",[t._v("\n          Date\n        ")])])}]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"not-found"},[t._v("\n  Can't found the path: "),n("b",[t._v(t._s(t.$route.fullPath))]),t._v(" "),n("div",[t._v("\n    Please check the url or Redirect to home page:\n    "),n("router-link",{attrs:{to:"/"}},[t._v("Home")])],1)])},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"hello"},[n("h1",[t._v(t._s(t.msg))]),t._v(" "),n("div",{domProps:{innerHTML:t._s(t.authorizeButtonHtml)}}),t._v(" "),n("router-link",{attrs:{to:"/kom"}},[t._v("Next")])],1)},staticRenderFns:[]}},function(t,e,n){t.exports={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{attrs:{id:"app"}},[o("img",{attrs:{src:n(14)}}),t._v(" "),o("router-view")],1)},staticRenderFns:[]}},function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",[t._v("\n    Please enter the email address to which you would like to notified\n  ")]),t._v(" "),n("form",{on:{submit:function(t){t.preventDefault()}}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.email,expression:"email"}],attrs:{type:"text"},domProps:{value:t.email},on:{input:function(e){e.target.composing||(t.email=e.target.value)}}}),t._v(" "),n("br"),t._v(" "),n("div",{staticStyle:{margin:"10px"}},[t._v("How often would you like to be notified?")]),t._v(" "),n("div",[n("input",{directives:[{name:"model",rawName:"v-model",value:t.frequency,expression:"frequency"}],attrs:{type:"radio",value:"daily",id:"daily"},domProps:{checked:t._q(t.frequency,"daily")},on:{__c:function(e){t.frequency="daily"}}}),n("label",{attrs:{for:"daily"}},[t._v("Daily")]),t._v(" "),n("br"),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.frequency,expression:"frequency"}],attrs:{type:"radio",value:"weekly",id:"weekly",checked:""},domProps:{checked:t._q(t.frequency,"weekly")},on:{__c:function(e){t.frequency="weekly"}}}),n("label",{attrs:{for:"weekly"}},[t._v("Weekly")]),t._v(" "),n("br"),t._v(" "),n("input",{directives:[{name:"model",rawName:"v-model",value:t.frequency,expression:"frequency"}],attrs:{type:"radio",value:"monthly",id:"monthly"},domProps:{checked:t._q(t.frequency,"monthly")},on:{__c:function(e){t.frequency="monthly"}}}),n("label",{attrs:{for:"monthly"}},[t._v("Monthly")]),t._v(" "),n("br"),t._v(" "),n("input",{staticClass:"btn btn-primary btn-sm",attrs:{type:"submit"},on:{click:t.submitForm}})])]),t._v(" "),n("div",{staticStyle:{margin:"10%"}},[n("button",{staticClass:"btn btn-success btn-send",attrs:{disabled:t.loading,type:"button"},on:{click:t.sendNotification}},[t._v("\n      Send Notification\n    ")]),t._v(" "),n("button",{staticClass:"btn btn-primary",class:{"btn-primary":!t.isPushEnabled,"btn-danger":t.isPushEnabled},attrs:{disabled:t.pushButtonDisabled||t.loading,type:"button"},on:{click:t.togglePush}},[t._v("\n      "+t._s(t.isPushEnabled?"Disable":"Enable")+" Push Notifications\n    ")])])])},staticRenderFns:[]}},,,,function(t,e){}],[6]);
//# sourceMappingURL=app.e9d1f4a2eddb9e23e015.js.map